<form (keydown)="onFormKeyDown($event)" (ngSubmit)="f.valid && submitForm.next(f.value)" #f="ngForm">
  <div class="modal-header">
    <h5 class="modal-title">{{ 'wireflow.proximity-modal.title' | translate }}</h5>
  </div>
  <div class="modal-body">
    <agm-map
      [latitude]="defLat"
      [longitude]="defLng"
      [zoom]="zoom"
      [disableDefaultUI]="false"
      [zoomControl]="false"
      (mapClick)="mapClicked($event)">

      <agm-marker
        *ngIf="marker"
        (markerClick)="clickedMarker(marker.label)"
        [latitude]="marker.lat"
        [longitude]="marker.lng"
        [label]="marker.label"
        [markerDraggable]="marker.draggable"
        (dragEnd)="markerDragEnd(marker, $event)">

        <agm-info-window>
          <strong>InfoWindow content</strong>
        </agm-info-window>

      </agm-marker>

      <agm-circle [latitude]="marker.lat || 0" [longitude]="marker.lng || 0"
                  [radius]="marker.radius * 1000"
                  [fillColor]="'red'"
                  [circleDraggable]="true"
                  (radiusChange)="radiusChange($event)"
                  (dragEnd)="circleDragEnd($event)"
                  [editable]="true">
      </agm-circle>

    </agm-map>

    <div class="mt-2">
      <div class="form-group">
        <label for="typeSelect">{{ 'wireflow.proximity-modal.selectType' | translate }}</label>
        <select class="form-control" id="typeSelect" name="selectedType" [(ngModel)]="selectedType" (ngModelChange)="onTypeChanged()">
          <option *ngFor="let item of types" [value]="item.value">{{ item.label }}</option>
        </select>
      </div>

      <div class="form-group">
        <label for="searchInput">{{ 'wireflow.proximity-modal.searchLocation' | translate }}</label>
        <input
          id="searchInput"
          placeholder="City"
          autocorrect="off"
          autocapitalize="off"
          spellcheck="off"
          type="text"
          class="form-control"
          #search
        />
      </div>

      <div class="form-group">
        <label for="longitudeInput">{{ 'wireflow.proximity-modal.longitude' | translate }}</label>
        <input
          id="longitudeInput"
          placeholder="{{ 'wireflow.proximity-modal.longitudePlaceholder' | translate }}"
          type="number"
          class="form-control"
          name="lng"
          [(ngModel)]="marker.lng"
          required
        />
      </div>

      <div class="form-group">
        <label for="latitudeInput">{{ 'wireflow.proximity-modal.latitude' | translate }}</label>
        <input
          id="latitudeInput"
          placeholder="{{ 'wireflow.proximity-modal.latitudePlaceholder' | translate }}"
          type="number"
          class="form-control"
          name="lat"
          [(ngModel)]="marker.lat"
          required
        />
      </div>

      <div class="form-group">
        <label for="radiusInput">{{ 'wireflow.proximity-modal.radius' | translate }}</label>
        <input
          id="radiusInput"
          placeholder="{{ 'wireflow.proximity-modal.radiusPlaceholder' | translate }}"
          type="number"
          class="form-control"
          name="radius"
          [(ngModel)]="marker.radius"
          required
        />
      </div>
    </div>

  </div>
  <div class="modal-footer">
    <button type="submit" class="btn btn-success">{{ 'wireflow.btns.confirm' | translate }}</button>
    <button type="reset" class="btn btn-secondary" (click)="cancel.next()">{{ 'wireflow.btns.cancel' | translate }}</button>
  </div>
</form>
